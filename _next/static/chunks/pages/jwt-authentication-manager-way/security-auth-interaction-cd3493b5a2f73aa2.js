(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[457],{2519:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/jwt-authentication-manager-way/security-auth-interaction",function(){return n(3306)}])},3306:function(e,s,n){"use strict";n.r(s),n.d(s,{__toc:function(){return c},default:function(){return d}});var r=n(5893),i=n(2673),t=n(373),o=n(8426);n(9128);var a=n(2643),l={src:"/docs-webflux-spring-security/_next/static/media/AUTHENTICATION-MANAGER-AND-PROVIDER-MANAGER.5242adc1.png",height:470,width:1173,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAADCAIAAAAhqtkfAAAAR0lEQVR42mP4////z58/f//+/e/fv79///6DAQagxK2bN16/fnXz5vV5c6Y9ffIEqO7Hjx8MEB1ApXfv3l6zaunTp09/ggEA+A9Cz4S8ynAAAAAASUVORK5CYII=",blurWidth:8,blurHeight:3};let c=[{depth:2,value:"시큐리티 인증 클래스들의 상호작용",id:"시큐리티-인증-클래스들의-상호작용"},{depth:2,value:"AuthenticationManager, AuthenticationProvider, ProviderManager",id:"authenticationmanager-authenticationprovider-providermanager"},{depth:2,value:"AuthenticationManagerResolver",id:"authenticationmanagerresolver"},{depth:2,value:"ReactiveAuthenticationManagerResolver",id:"reactiveauthenticationmanagerresolver"},{depth:2,value:"foobar-user 는?",id:"foobar-user-는"}];function _createMdxContent(e){let s=Object.assign({h2:"h2",p:"p",img:"img",code:"code",pre:"pre",span:"span"},(0,a.a)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.h2,{id:"시큐리티-인증-클래스들의-상호작용",children:"시큐리티 인증 클래스들의 상호작용"}),"\n",(0,r.jsx)(s.h2,{id:"authenticationmanager-authenticationprovider-providermanager",children:"AuthenticationManager, AuthenticationProvider, ProviderManager"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{placeholder:"blur",src:l})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"ProviderManager"})," 는 AuthenticationProvider 인스턴스들을 List 형태로 가지고있으면서 관리하는 객체입니다. 즉 Provider 들을 Manage 하는 객체입니다. 이 ",(0,r.jsx)(s.code,{children:"ProviderManager"})," 는 ",(0,r.jsx)(s.code,{children:"AuthenticationManager"})," 인터페이스를 구현한 기본 구현체입니다.",(0,r.jsx)("br",{})]}),"\n",(0,r.jsx)(s.h2,{id:"authenticationmanagerresolver",children:"AuthenticationManagerResolver"}),"\n",(0,r.jsxs)(s.p,{children:["AuthenticationManager 를 기본 구현한 클래스는 ProviderManager 이고 스프링에서 기본으로 제공하지만, 여러가지 종류의 AuthenticationManager 를 구현해서 사용하고 싶을 수 있습니다. 인증 로직이 복잡해질 수록 한군데에 하드코딩한 로직들은 점점 갈 수록 장애를 내게 될 확률이 높기에 시기 적절하게 항상 기능별로 모듈화를 해두는 것이 좋습니다. 따라서 용도별로 AuthenticationManager 를 분리해서 정의하는 경우가 많습니다.",(0,r.jsx)("br",{})]}),"\n",(0,r.jsxs)(s.p,{children:["이렇게 용도별로 분리해둔 AuthenticationManager 들 중에서 Filter 가 어떤 AuthenticationManager 를 사용할지 결정할 수 있도록 하는 역할을 하는 것이 ",(0,r.jsx)(s.code,{children:"AuthenticationManagerResolver"})," 입니다. 말 그대로 ",(0,r.jsx)(s.code,{children:"AuthenticationManager"})," 를 resolve 하는 역할을 수행합니다.",(0,r.jsx)("br",{})]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(s.p,{children:"예를 들어 아래와 같은 시큐리티 클래스가 있다고 해보겠습니다."}),"\n",(0,r.jsx)(s.pre,{"data-language":"java","data-theme":"default",children:(0,r.jsxs)(s.code,{"data-language":"java","data-theme":"default",children:[(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"@"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Configuration"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"public"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"SucurityConfig"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// ..."})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsxs)(s.p,{children:["그리고 ",(0,r.jsx)(s.code,{children:"customerAuthenticationManager"})," 라는 이름의 Bean 을 아래와 같이 생성한다고 해보겠습니다. 예제이기에 간단하게 인라인 형식으로 단순하게 만들었습니다."]}),"\n",(0,r.jsx)(s.pre,{"data-language":"java","data-theme":"default",children:(0,r.jsxs)(s.code,{"data-language":"java","data-theme":"default",children:[(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"@"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Bean"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"AuthenticationManager"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"customersAuthenticationManager()"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" authentication "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"isCustomer(authentication)"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"new"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"UsernamePasswordAuthenticationToken("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"/*credentials*/"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:")"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        }"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"throw"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"new"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"UsernameNotFoundException("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"/*principal name*/"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:")"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    };"})}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsxs)(s.p,{children:["이번에는 ",(0,r.jsx)(s.code,{children:"employeesAuthenticationManager"})," 라는 이름의 Bean 을 아래와 같이 생성해봅니다. 예제 수준의 단순한 인라인 정 코드입니다."]}),"\n",(0,r.jsx)(s.pre,{"data-language":"java","data-theme":"default",children:(0,r.jsxs)(s.code,{"data-language":"java","data-theme":"default",children:[(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"@"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Bean"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"public"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"AuthenticationManager"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"employeesAuthenticationManager()"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" authentication "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"isEmployee(authentication)"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"new"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"UsernamePasswordAuthenticationToken("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"/*credentials*/"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:")"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        }"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"throw"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"new"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"UsernameNotFoundException("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"/*principal name*/"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:")"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    };"})}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsxs)(s.p,{children:["이렇게 정의해둔 ",(0,r.jsx)(s.code,{children:"AuthenticationManager"})," 들은 어떤 기준에 의해 선택이 될수 있어야 합니다. ",(0,r.jsx)(s.code,{children:"AuthenticationManagerResolver"})," 에는 이런 AuthenticationManager 들을 특정 기준에 의해 선택하는 코드를 작성합니다."]}),"\n",(0,r.jsx)(s.pre,{"data-language":"java","data-theme":"default",children:(0,r.jsxs)(s.code,{"data-language":"java","data-theme":"default",children:[(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"AuthenticationManagerResolver<"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"HttpServletRequest"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"resolver()"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" request "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"request"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"getPathInfo"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"()"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"startsWith"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"/employee"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")) {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"employeesAuthenticationManager()"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        }"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"customersAuthenticationManager()"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    };"})}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(s.h2,{id:"reactiveauthenticationmanagerresolver",children:"ReactiveAuthenticationManagerResolver"}),"\n",(0,r.jsxs)(s.p,{children:["이번에는 위에서 살펴본 ",(0,r.jsx)(s.code,{children:"AuthenticationManager"})," 를 Reactive 버전으로 작성해봅니다.",(0,r.jsx)("br",{})]}),"\n",(0,r.jsxs)(s.p,{children:["예를 들어 아래와 같은 시큐리티 클래스가 있다고 해보겠습니다. 아까와 달라진 점은 ",(0,r.jsx)(s.code,{children:"@EnableWebFluxSecurity"}),", ",(0,r.jsx)(s.code,{children:"@EnableReactiveMethodSecurity"})," 을 추가해줬다는 점입니다."]}),"\n",(0,r.jsx)(s.pre,{"data-language":"java","data-theme":"default",children:(0,r.jsxs)(s.code,{"data-language":"java","data-theme":"default",children:[(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"@"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"EnableWebFluxSecurity"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"@"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"EnableReactiveMethodSecurity"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"public"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"SucurityConfig"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// ..."})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsxs)(s.p,{children:["그리고 ",(0,r.jsx)(s.code,{children:"customerAuthenticationManager"})," 라는 이름의 Bean 을 아래와 같이 생성한다고 해보겠습니다. 예제이기에 간단하게 인라인 형식으로 단순하게 만들었습니다. 아까와 달라진 점은 ",(0,r.jsx)(s.code,{children:"ReactiveAuthenticationManager"})," 를 반환한다는 점입니다."]}),"\n",(0,r.jsx)(s.pre,{"data-language":"java","data-theme":"default",children:(0,r.jsxs)(s.code,{"data-language":"java","data-theme":"default",children:[(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"@"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Bean"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"public"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"ReactiveAuthenticationManager"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"customersAuthenticationManager()"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" authentication "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"isCustomer(authentication)"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"new"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"UsernamePasswordAuthenticationToken("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"/*credentials*/"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:")"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        }"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"throw"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"new"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"UsernameNotFoundException("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"/*principal name*/"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:")"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    };"})}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsxs)(s.p,{children:["이번에는 ",(0,r.jsx)(s.code,{children:"employeesAuthenticationManager"})," 라는 이름의 Bean 을 아래와 같이 생성해봅니다. 예제 수준의 단순한 인라인 코드입니다. 아까와 달라진 점은 ",(0,r.jsx)(s.code,{children:"ReactiveAuthenticationManager"})," 를 반환한다는 점입니다."]}),"\n",(0,r.jsx)(s.pre,{"data-language":"java","data-theme":"default",children:(0,r.jsxs)(s.code,{"data-language":"java","data-theme":"default",children:[(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"@"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Bean"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"public"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"ReactiveAuthenticationManager"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"employeesAuthenticationManager()"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" authentication "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"isEmployee(authentication)"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"new"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"UsernamePasswordAuthenticationToken("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"/*credentials*/"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:")"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        }"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"throw"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"new"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"UsernameNotFoundException("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"/*principal name*/"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:")"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    };"})}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(s.p,{children:"이렇게 정의한 ReactiveAuthenticationManager 들은 아래와 같이 ReactiveAuthenticationManagerResolver 에서 적절한 ReactiveAuthenticationManager 를 선택하도록 정의하는 것이 가능합니다."}),"\n",(0,r.jsx)(s.pre,{"data-language":"java","data-theme":"default",children:(0,r.jsxs)(s.code,{"data-language":"java","data-theme":"default",children:[(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"ReactiveAuthenticationManagerResolver<"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"ServerWebExchange"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"resolver()"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" exchange "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"match("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"exchange"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"getRequest()"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"/employee"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:")"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Mono"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"just"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"employeesAuthenticationManager()"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        }"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Mono"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"just"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"customersAuthenticationManager()"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    };"})}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsxs)(s.h2,{id:"foobar-user-는",children:[(0,r.jsx)(s.code,{children:"foobar-user"})," 는?"]}),"\n",(0,r.jsxs)(s.p,{children:["제가 작성한 ",(0,r.jsx)(s.code,{children:"foobar-user"})," 에서는 ReactiveAuthenticationManagerResolver 까지 사용하지는 않았고 1개의 ReactiveAuthenticationManager를 Filter 에 등록해서 사용하는 방식으로 아래와 같이 사용했습니다."]})]})}let h={MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,a.a)(),e.components);return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(_createMdxContent,{...e})}):_createMdxContent(e)},pageOpts:{filePath:"pages/jwt-authentication-manager-way/security-auth-interaction.mdx",route:"/jwt-authentication-manager-way/security-auth-interaction",timestamp:1709607195e3,pageMap:[{kind:"MdxPage",name:"index",route:"/"},{kind:"Folder",name:"jwt-authentication-manager-way",route:"/jwt-authentication-manager-way",children:[{kind:"MdxPage",name:"example-using-reactive-authentication-manager",route:"/jwt-authentication-manager-way/example-using-reactive-authentication-manager"},{kind:"MdxPage",name:"security-auth-interaction",route:"/jwt-authentication-manager-way/security-auth-interaction"},{kind:"Meta",data:{"example-using-reactive-authentication-manager":"ReactiveAuthenticationManager 기반의 인증","security-auth-interaction":"시큐리티 인증 클래스들의 상호작용"}}]},{kind:"Folder",name:"jwt-basic",route:"/jwt-basic",children:[{kind:"MdxPage",name:"jwt-generate-degenerate-example",route:"/jwt-basic/jwt-generate-degenerate-example"},{kind:"MdxPage",name:"what-is-jwt",route:"/jwt-basic/what-is-jwt"},{kind:"Meta",data:{"what-is-jwt":"JWT 란?","jwt-generate-degenerate-example":"JWT 생성, 분해 예제"}}]},{kind:"Folder",name:"oauth2",route:"/oauth2",children:[{kind:"MdxPage",name:"Intro",route:"/oauth2/Intro"},{kind:"Meta",data:{intro:"Intro",Intro:"Intro"}}]},{kind:"Folder",name:"servlet-security-auth",route:"/servlet-security-auth",children:[{kind:"MdxPage",name:"intro",route:"/servlet-security-auth/intro"},{kind:"Meta",data:{intro:"Intro"}}]},{kind:"Meta",data:{index:"Introduction","jwt-basic":"JWT 개념","jwt-authentication-manager-way":"AuthenticationManager 방식의 JWT  인증",oauth2:"OAuth2","servlet-security-auth":"servlet 기반의 시큐리티 JWT 인증",contact:{title:"Contact ↗",type:"page",href:"-",newWindow:!0}}}],flexsearch:{codeblocks:!0},title:"Security Auth Interaction",headings:c},pageNextRoute:"/jwt-authentication-manager-way/security-auth-interaction",nextraLayout:t.ZP,themeConfig:o.Z};var d=(0,i.j)(h)},8426:function(e,s,n){"use strict";var r=n(5893);n(7294);let i={logo:(0,r.jsx)("span",{children:"Docs Webflux Spring Security"}),project:{link:"https://github.com/chagchagchag/docs-webflux-spring-security"},docsRepositoryBase:"https://github.com/chagchagchag/docs-webflux-spring-security",footer:{text:"Nextra Docs Template"}};s.Z=i},5789:function(){}},function(e){e.O(0,[774,796,888,179],function(){return e(e.s=2519)}),_N_E=e.O()}]);